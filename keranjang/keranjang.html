<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Keranjang Belanja - Warung Mama Ocit</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-success">
    <div class="container">
      <a class="navbar-brand fw-bold" href="index.html">Warung Mama Ocit</a>
    </div>
  </nav>

  <main class="container py-5">
    <h2 class="mb-4 text-center">Keranjang Belanja</h2>

    <div id="daftarKeranjang" class="mb-4"></div>

    <div class="text-end">
      <h4>Total: <span id="totalHarga">Rp0</span></h4>
      <a id="btnCheckout" class="btn btn-success btn-lg mt-2" href="#">Checkout via WhatsApp</a>
    </div>
  </main>

  <footer class="bg-success text-white text-center py-3">
    <p>&copy; 2025 Warung Mama Ocit</p>
  </footer>

  <script>
    const daftarKeranjang = document.getElementById('daftarKeranjang');
    const totalHargaEl = document.getElementById('totalHarga');
    const btnCheckout = document.getElementById('btnCheckout');

    let keranjang = JSON.parse(localStorage.getItem('keranjang')) || [];

    function formatRupiah(angka) {
      return 'Rp' + angka.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    }

    function tampilkanKeranjang() {
      if (keranjang.length === 0) {
        daftarKeranjang.innerHTML = '<p class="text-muted">Keranjang kosong.</p>';
        btnCheckout.style.display = 'none';
        return;
      }

      let html = '<ul class="list-group mb-3">';
      let total = 0;

      keranjang.forEach((item, index) => {
        total += item.harga;
        html += `
          <li class="list-group-item d-flex justify-content-between align-items-center">
            ${item.nama}
            <span>${formatRupiah(item.harga)}</span>
            <button class="btn btn-sm btn-danger" onclick="hapusItem(${index})">Hapus</button>
          </li>
        `;
      });

      html += '</ul>';
      daftarKeranjang.innerHTML = html;
      totalHargaEl.textContent = formatRupiah(total);

      const pesan = keranjang.map(i => `- ${i.nama}: ${formatRupiah(i.harga)}`).join('%0A');
      const totalText = `Total: ${formatRupiah(total)}`;
      const nomorWa = '6281010057730';
      const linkWa = `https://wa.me/${6281010057730}?text=Halo%20saya%20ingin%20pesan%20makanan:%0A${pesan}%0A${totalText}`;
      btnCheckout.href = linkWa;
    }

    function hapusItem(index) {
      keranjang.splice(index, 1);
      localStorage.setItem('keranjang', JSON.stringify(keranjang));
      tampilkanKeranjang();
    }

    tampilkanKeranjang();
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
